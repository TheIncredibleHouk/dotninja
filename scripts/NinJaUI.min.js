function Animation(n,t,i,r,u,f){this.Element=n;this.Property=t;this.From=i;this.To=r;this.__oto=r;this.__ofrom=i;this.Frames=f;this.Value=i;this.__ostep=f;this.Timer=new Timer(u/f,!0);this.Timer.OnTrigger.Add(new Delegate(this.Next,this));this.OnFinish=null}function Size(n,t){this.Width=n;this.Height=t}function Point(n,t){this.X=n;this.Y=t}function Bounds(n,t,i,r){this.Left=n||0;this.Right=t||0;this.Top=i||0;this.Bottom=r||0;this.Center=(this.Right-this.Left)/2+this.Left;this.Middle=(this.Bottom-this.Top)/2+this.Top}function Accordion(n){var t,u,f,i,r;if(this.DOM===undefined)return Accordion.Inherit(Accordion.Extend(new Div(n).ClassName("accordion")));for(t=this,n=t.DOM,t.__si=null,t.__hc=n.getAttribute("headerclass")||"accordionheader",t.__sc=n.getAttribute("selectedclass")||"selected",t.__il=n.getAttribute("itemclass")||"accordionitem",t.Items=new ObservableArray(t),u=Array.From(n.children),f=u.length,r=0;r<f;r++)i=u[r],i.tagName=="DIV"&&(i=i.$,AccordionItem.Extend(AccordionItem.Inherit(i)),t.Items.Add(i),t.InsertElementBefore(i.Header,i),i.Classes.Add(t.__il),i.Header.Classes.Add(t.__hc));t.Items.OnChange.Add(new Delegate(t.__ItemsChanged,t,[Delegate.Event]));t.OnSelectionChanged=new Event}function AccordionItem(n){var t,i;if(this.DOM===undefined)return AccordionItem.Inherit(AccordionItem.Extend(new Div(n)));t=this;n=t.DOM;i=n.getAttribute("header");t.Collapsed(!0);t.Header=(new Div).Cursor(Cursor.Pointer);i&&t.Header.Text(i);i=t.ElementsByClassName("header");i[0]&&(i=$Div(i[0]),i.DOM.parentNode.removeChild(i.DOM),t.Header.AddElement(i));t.__sd=(n.getAttribute("selected")||"false").ToBoolean();t.Header.OnClick.Add(new Delegate(t.Toggle,t,["Selected"]))}function DatePicker(n){var t,r,o,s,h,u,c,i,f,e;if(this.DOM===undefined)return DatePicker.Inherit(DatePicker.Extend(new TextBox(n).ClassName("datepicker")));for(t=this,n=t.DOM,t.__ui=(n.getAttribute("useicon")||"false").ToBoolean(),t.__dp=(new Div).Style("position", "absolute").Collapsed(!0),r=t.__Table=(new Table).ClassName("datepicker").CellPadding(0).CellSpacing(0).Style(Style.TableLayout,"fixed").Style(Style.ZIndex,NinJaUI.ZIndex++),r.SetHead(new TableHead),t.__dp.AddElement(r),t.__pc=n.getAttribute("padclass")||"pad",t.__pd=(n.getAttribute("pad")||"false").ToBoolean(),t.__sd=n.getAttribute("selectedclass")||"selected",t.__CS=null,i=t.Text(),i=i&&i.IsDate()?new DateTime(i):DateTime.Now(),t.__D=i.Date(),t.__M=i.Month(),t.__Y=i.Year(),t.OnDateChanged=new Event(t),f=(new Anchor).Text("<"),e=(new Anchor).Text(">"),f.DOM.tabIndex=e.DOM.tabIndex=1e6,r.Head.Rows.Add((new Row).HorizontalAlignment("center")),r.Head.Rows[0].Cells.AddRange([(new Cell).AddElement(f),(new Cell).ColumnSpan(5),(new Cell).AddElement(e)]),r.Rows.Add((new Row).HorizontalAlignment("center")),r.Rows[0].Cells.AddRange([(new Header).Text("S"),(new Header).Text("M"),(new Header).Text("T"),(new Header).Text("W"),(new Header).Text("T"),(new Header).Text("F"),(new Header).Text("S")]),n.onselectstart!==undefined?n.onselectstart=function(){return!1}:t.OnClick.Add(function(n){n.Handled=n.CancelEvent=!0}),c=[],i=new Delegate(t.__dd,t,[Delegate.Event]),s=0;s<6;s++){for(o=[new Cell,new Cell,new Cell,new Cell,new Cell,new Cell,new Cell],u=0;u<7;u++)o[u].OnClick.Add(i);h=(new Row).HorizontalAlignment("center");h.Cells.AddRange(o);c.Add(h)}r.Rows.AddRange(c);f.OnClick.Add(new Delegate(t.__cm,t,[-1]));e.OnClick.Add(new Delegate(t.__cm,t,[1]));t.__ui===!1?(t.OnFocus.Add(new Delegate(t.Show,t)),t.OnClick.Add(new Delegate(t.Show,t)),t.OnBlur.Add(new Delegate(t.Hide,t)),t.OnBlur.Add(new Delegate(t._fd,t)),t.OnKeyUp.Add(new Delegate(t.Update,t))):(t.OnKeyUp.Add(new Delegate(t.Update,t)),t.OnBlur.Add(new Delegate(t.Hide,t)),t.__ic=(new ImageElement).Source(DatePicker.ImageIconUrl).ClassName("datepickericon").Attribute("nobind","true"),t.__ic.OnClick.Add(new Delegate(t.Show,t)),t.Parent().InsertElementAfter(t.__ic,t));Page.OnClick.Add(new Delegate(t.Hide,t));Page.AddElement(t.__dp);t.Refresh()}function Dialog(n){if(this.DOM===undefined)return Dialog.Inherit(Dialog.Extend(new Div(n).ClassName("dialog")));var t=this;n=t.DOM;n.parentNode&&n.parentNode.removeChild(n);Dialog.Dialogs.AddElement(n);t.OnDialogShow=new Event(t);t.OnDialogClose=new Event(t);t.Result=null}function DynamicSize(n){this.Value=null;this.DynamicSizeType=DynamicSizeType.Liquid;this.Type=Type.DynamicSize;switch(n.Type){case Type.String:n.EndsWith("%")?(this.Value=n.Remove("%").ToFloat()/100,this.DynamicSizeType=DynamicSizeType.Relative):n=="*"?(this.Value=null,this.DynamicSizeType=DynamicSizeType.Liquid):n.IsInt()&&(this.Value=n.ToInt(),this.DynamicSizeType=DynamicSizeType.Static);break;case Type.Number:this.Value=n;this.DynamicSizeType=DynamicSizeType.Static}}function OneClickAnchor(n){if(this.DOM===undefined)return OneClickAnchor.Inherit(OneClickAnchor.Extend(new Anchor(n).ClassName("oneclick")));var t=this;t.OnClick.Add(new Delegate(t.Enabled,t,[!1]))}function OneClickButton(n){if(this.DOM===undefined)return OneClickAnchor.Inherit(OneClickAnchor.Extend(new Button(n).ClassName("oneclick")));var t=this;this.Enabled=Element.prototype.Enabled;t.OnClick.Add(new Delegate(t.Enabled,t,[!1]))}function OneClickContentButton(n){if(this.DOM===undefined)return OneClickAnchor.Inherit(OneClickAnchor.Extend(new ContentButton(n).ClassName("oneclick")));var t=this;t.OnClick.Add(new Delegate(t.Enabled,t,[!1]))}function RollOverImage(n){if(this.DOM===undefined)return RollOverImage.Inherit(RollOverImage.Extend(new ImageElement(n).ClassName("rollover")));var t=this;return n=t.DOM,t.__H=n.getAttribute("hover")||"",t.__OS=ImageElement.prototype.Source,t.__MOv=new Delegate(t.__OS,t,[t.__H]),t.__MOu=new Delegate(t.__OS,t,[n.src]),t.__H!=null&&(t.OnMouseOver.Add(t.__MOv),t.OnMouseOut.Add(t.__MOu)),n}function HorizontalScrollBar(){var n=(new Div).ClassName("scrollbarl").Attribute("direction","horizontal");return ScrollBar.Inherit(ScrollBar.Extend(n))}function ScrollBar(n){var t,u,f,i,e,r;if(this.DOM===undefined)return ScrollBar.Inherit(ScrollBar.Extend(new Div(n).ClassName("scrollbar")));t=this;n=t.DOM;t.__Orient=n.getAttribute("direction")||"vertical";this.ClassName(t.__Orient=="vertical"?"vscrollbar":"hscrollbar");t.__Width=Element.prototype.Width;t.__Height=Element.prototype.Height;t.Width=ScrollBar.prototype.Width;t.Height=ScrollBar.prototype.Height;u=n.getAttribute("swidth")||t.__Orient=="horizontal"?"100":"15";f=n.getAttribute("sheight")||t.__Orient=="horizontal"?"16":"100";t.ClearTextNodes().Style(Style.Display,"inline-block").Style(Style.BoxSizing,"border-box").NaturalDisplay="inline-block";u&&t.__Width(u.ToInt());f&&t.__Height(f.ToInt());i=t.ElementsByClassName("decrease")[0];i||(i=new Div,t.AddElement(i));t.DecreaseThumb=i.ClassName("decrease thumb").Style(Style.BoxSizing,"border-box");i=t.ElementsByClassName("increase")[0];i||(i=new Div,t.AddElement(i));t.IncreaseThumb=i.ClassName("increase thumb");i=t.ElementsByClassName("track")[0];i?(t.TrackThumb=i.ClassName("track thumb"),t.RemoveElement(t.TrackThumb)):(t.TrackThumb=TrackThumb.Inherit(TrackThumb.Extend(new Div)),t.TrackThumb.ClassName("track thumb"));t.Track=(new Div).Style(Style.BoxSizing,"border-box");t.InsertElement(1,t.Track);t.Track.AddElement(t.TrackThumb);t.__Value=0;t.__Orient=="horizontal"?(t.IncreaseThumb.Style(Style.Display,"inline-block"),t.DecreaseThumb.Style(Style.Display,"inline-block"),t.Track.Style(Style.Display,"inline-block").Height(15),t.IncreaseThumb.Width(15).Height(16),t.DecreaseThumb.Width(15).Height(16),t.TrackThumb.Height(16)):(t.IncreaseThumb.Width(15).Height(16),t.DecreaseThumb.Width(15).Height(16));e=(n.getAttribute("maxvalue")||"10").ToInt();t.Track.OnMouseWheel.Add(new Delegate(t.__HandleScroll,t,[Delegate.Event]));t.Track.OnClick.Add(new Delegate(t.__HandleTrackClick,t,[Delegate.Event]));r=new Delegate(t.Decrease,t);t.DecreaseThumb.OnClick.Add(r);t.DecreaseThumb.OnDoubleClick.Add(r);r=new Delegate(t.Increase,t);t.IncreaseThumb.OnClick.Add(r);t.IncreaseThumb.OnDoubleClick.Add(r);t.__RefreshView();t.MaxValue(e);t.OnScrollChange=new Event;t.__Tb=1}function TrackThumb(){var n=this;n.Style(Style.BoxSizing,"border-box").Style("position", "relative");n.OnMouseDown.Add(new Delegate(n.CaptureMove,n));n.TrackDelegate=new Delegate(n.Move,n);n.TrackDelegate.Enabled=!1;n.OnClick.Add(function(n){n.Handled=!0});Page.OnMouseMove.Add(n.TrackDelegate);Page.OnMouseUp.Add(new Delegate(n.LoseMove,n))}function RangeSlider(){var n,t,i;if(this.DOM===undefined)return ScrollBar.Inherit(ScrollBar.Extend(new Div(t).ClassName("rangeslider")));n=this;t=n.DOM;n.__min=(t.getAttribute("min")||"0").ToFloat();n.__max=(t.getAttribute("max")||"100").ToFloat();n.__Orient="horizontal";n.OnChange=new Event(n);n.RangeThumb=RangeSliderThumb.Inherit(RangeSliderThumb.Extend(new Div)).ClassName("rangetrackthumb").Style(Style.Overflow,"visible");n.LowerThumb=RangeSliderThumb.Inherit(RangeSliderThumb.Extend(new Div));n.UpperThumb=RangeSliderThumb.Inherit(RangeSliderThumb.Extend(new Div));i=[n.RangeThumb,n.LowerThumb,n.UpperThumb];n.__Draw=(t.getAttribute("showticks")||"false").ToBoolean();Client.Browser.Type==BrowserType.InternetExplorer&Client.Browser.Version==8&&(n.__Draw=!1);n.__Draw===!0&&(n.__Canvas=(new Canvas).Style("position", "absolute").ClassName("rangeticks").CanvasWidth(n.Width()).CanvasHeight((t.getAttribute("tickheight")||"10").ToInt()),i.Insert(0,n.__Canvas),n.__P=new Pen(new Color(t.getAttribute("tickcolor")||Colors.Black),1),n.__H=(t.getAttribute("tickheight")||"10").ToInt());n.AddElements(i);n.__Ticks=[];n.__Steps=t.getAttribute("steps");NullOrUndefined(n.__Steps)?n.Interval((t.getAttribute("interval")||"10").ToFloat()):n.Steps(n.__Steps);n.LowerThumb.Value(n.__min);n.UpperThumb.Value(n.__max);Client.OnResize.Add(new Delegate(this.RefreshDisplay,this))}function RangeSliderThumb(){var n=this;n.__Value=0;n.Style(Style.BoxSizing,"border-box").Style("position", "absolute").ClassName("rangesliderthumb").Style("z-index","1");n.OnMouseDown.Add(new Delegate(n.CaptureMove,n));n.TrackDelegate=new Delegate(n.Move,n);n.TrackDelegate.Enabled=!1;n.OnClick.Add(function(n){n.Handled=!0});Page.OnMouseMove.Add(n.TrackDelegate);Page.OnMouseUp.Add(new Delegate(n.LoseMove,n))}function SuggestionBox(n){if(this.DOM===undefined)return SuggestionBox.Inherit(SuggestionBox.Extend(new TextBox(n).ClassName("suggestion")));var t=this;n=t.DOM;n.setAttribute("autocomplete","off");t.__dp=(new Div).Style("position", "absolute").Collapsed(!0);t.__cs=n.getAttribute("displayclass")||"display";t.__FocusClass=n.getAttribute("focusclass")||"focus";t.__Source=n.getAttribute("source")||null;t.__MinLength=(n.getAttribute("minlength")||"3").ToInt();t.__Text=n.getAttribute("bindtext")||"";t.__SText=n.getAttribute("selecttext")||t.__Text;t.__Value=n.getAttribute("bindvalue")||"";t.__AnchorCache=[];t.__CurrentAnchors=[];t.__CurrentAnchor=null;t.__StopShow=!1;t.__Header=n.getAttribute("header")||"";t.OnSuggestionSelected=new Event(t);t.__Source&&(t.__Source=NinJa.EvalBind(t.__Source,window,!0));Page.AddElement(t.__dp);t.__dp.Style("overflow-y","auto");t.__dp.Style("overflow-x","hidden");t.Data=new Array(20);t.DisplayClass(t.__cs);t.__CheckCache();t.Data=new ObservableArray(t);t.OnSuggestionSelected=new Event(t);t.OnFocus.Add(new Delegate(t.__HandleKeyUp,t));t.OnBlur.Add(new Delegate(t.HideSuggestions,t));t.OnKeyDown.Add(new Delegate(t.__HandleKeyDown,t,[Delegate.Event]));t.OnKeyUp.Add(new Delegate(t.__HandleKeyUp,t,[Delegate.Event]));t.OnClick.Add(new Delegate(t.__MuffleClick));t.__h=(new Span).Text(t.__Header);t.__dp.AddElement(t.__h);t.__st="";Page.OnClick.Add(new Delegate(t.HideSuggestions,t))}function Template(n){if(this.DOM===undefined)return Template.Inherit(Template.Extend(new Div(n).ClassName("template")));this.Bind(null)}function TemplateList(n){if(this.DOM===undefined)return TemplateList.Inherit(TemplateList.Extend(new Div(n).ClassName("templatelist")));var t=this;n=t.DOM;t.Items=new ObservableArray;t.Items.OnChange.Add(new Delegate(t.ItemsChanged,t,[Delegate.Event]));t.__Template=(new Div).AddElements(Array.From(n.childNodes)).DOM;t.ClearContent();t.__EmptyText="No items.";t.EmptyText=(new Div).ClassName("empty").Text(t.__EmptyText).Collapsed(!0);t.AddElement(t.EmptyText);t.__S=t.Classes.Contains("sortable");t.OnSorted=new Event}function TemplateTableList(n){if(this.DOM===undefined)return TemplateTableList.Inherit(TemplateTableList.Extend(new Table(n).ClassName("templatelist")));var t=this;t.Items=new ObservableArray;t.Items.OnChange.Add(new Delegate(t.ItemsChanged,t,[Delegate.Event]));t.__Template=NinJa.CloneNode(t.Body.Rows[0].DOM);t.EmptyText=(new Cell).ColumnSpan(t.Rows[0].Cells.length);t.EmptyRow=new Row;t.EmptyRow.Cells.Add(this.EmptyText);t.Rows.Clear()}function TemplateRow(n){if(this.DOM===undefined)return TemplateRow.Inherit(TemplateRow.Extend(new Row(n).ClassName("template")));n!==undefined&&this.Bind(null)}function WaterMarkTextBox(n){if(this.DOM===undefined)return WaterMarkTextBox.Inherit(WaterMarkTextBox.Extend(new TextBox(n).ClassName("watermark")));var t=this;n=t.DOM;t.Classes.Remove("watermark");t.__WaterMarkValue=n.getAttribute("watermarkvalue")||"";t.__Overlay=(new Span).Text(t.__WaterMarkValue).Style("position", "absolute").ClassName("watermark").Style("text-align",t.Style("text-align")).Attribute("nobind","true");t.__Overlay.OnClick.Add(new Delegate(t.Focus,t));t.Parent().InsertElementBefore(t.__Overlay,t);t.OnChange.Add(new Delegate(t.__CheckValue,t));t.OnKeyUp.Add(new Delegate(t.__CheckValue,t));t.__CheckValue();t.HasValue=!1}function CheckBoxList(n){var t,u,e,r,i,f;if(this.DOM===undefined)return CheckBoxList.Inherit(CheckBoxList.Extend(new Span(n).ClassName("checkboxlist")));for(t=this,n=t.DOM,t.Items=new ObservableArray(t),t.SelectedItems=new ObservableArray(t),u=Array.From(n.childNodes),e=u.length,r=0;r<e;r++)i=u[r],i.tagName=="SPAN"&&(t.Items.Add(i.$),CheckBoxListItem.Inherit(CheckBoxListItem.Extend(i.$,i)),i.$.Parent=this,i.$.Selected()&&t.SelectedItems.Add(i.$));t.Items.OnChange.Add(new Delegate(t.__UpdateItems,t,[Delegate.Event]));t.SelectedItems.OnChange.Add(new Delegate(t.__SelectedItemsChanged,t,[Delegate.Event]));t.__Updating=!1;t.__bt=n.getAttribute("bindtext")||"";t.__bv=n.getAttribute("bindvalue")||"";t.OnChange=t.OnSelectionChanged=new Event(t);f=n.getAttribute("onchange");f&&t.OnSelectionChanged.Add(new Function(f))}function CheckBoxListItem(n){var t,u,f,r,i;if(this.DOM===undefined)return CheckBoxListItem.Inherit(CheckBoxListItem.Extend(new Span(n)));for(t=this,n=t.DOM,u=Array.From(n.childNodes),f=u.length,r=0;r<f;r++)i=u[r],i.tagName=="INPUT"&&i.type=="checkbox"?(t.__cb=i.$,t.__Value=n.getAttribute("value")||""):i.tagName=="LABEL"&&(t.__lb=i.$);t.__cb===undefined&&(t.__cb=new CheckBox("cbx"+CheckBoxListItem.IdGen++),t.__lb=(new Label).For(t.__cb.DOM.id),t.AddElements([t.__cb,t.__lb]));t.__cb.OnCheckChanged.Add(new Delegate(t.__np,t));t.Parent=null;t.Enabled(t.__cb.Enabled());t.__Updating=!1}function FloatBox(n){if(this.DOM===undefined)return FloatBox.Inherit(FloatBox.Extend(new Div(n).ClassName("floatbox")));var t=this;Client.OnScroll.Add(new Delegate(t.CheckFloatMode,t))}function Tab(n){var t,u,r,i,f;if(this.DOM===undefined)return Tab.Inherit(Tab.Extend(new Div(n).ClassName("tab")));for(t=this,n=t.DOM,t.__si=null,t.Container=(new Div).ClassName("tabcontainer").Height("100%"),t.Header=(new Div).ClassName("tabheaderpanel"),t.TabItems=new ObservableArray(n),u=Array.From(n.children),f=u.length,r=0;r<f;r++)i=u[r],i.tagName=="DIV"&&(i=TabItem.Inherit(TabItem.Extend(i.$)),t.TabItems.Add(i),i.DOM.parentNode&&i.DOM.parentNode.removeChild(i.DOM),i.Header.DOM.parentNode&&i.Header.DOM.parentNode.removeChild(i.Header.DOM),t.Header.AddElement(i.Header),t.Container.AddElement(i));t.__TabLocation=(n.getAttribute("TabLocation")||"top").toLowerCase();t.AddElements([t.Header,t.Container]);t.TabLocation(t.__TabLocation);t.OnSelectionChanged=new Event;t.TabItems.OnChange.Add(new Delegate(t.Update,t,[Delegate.Event]));t.SelectedItem(t.TabItems[0]);this.Container.Style("min-height",this.Header.LayoutHeight()+"px")}function TabItem(n){if(this.DOM===undefined)return TabItem.Inherit(TabItem.Extend(new Div(n).ClassName("item")));var t=this;n=t.DOM;t.Style("zoom","1");t.Header=t.ElementsByClassName("tabitemheader")[0];t.Classes.Add("tabitem");t.Header?TabHeader.Inherit(TabHeader.Extend(t.Header)):t.Header=(new TabHeader).Text(n.getAttribute("header")||"");t.OnSelected=new Event(t);t.Style("vertical-align","top");t.__OEnabled=Element.prototype.Enabled;t.Header.OnClick.Add(new Delegate(t.Selected,t,[!0]));t.Collapsed(!0)}function TabHeader(n){if(this.DOM===undefined)return TabHeader.Inherit(TabHeader.Extend(new Div(n).ClassName("tabitemheader")))}function Menu(n){var t,f,o,u,i,s,r,h,e;if(this.DOM===undefined)return Menu.Inherit(Menu.Extend(new List(n).ClassName("menu")));if(t=this,n=this.DOM,t.__ChildClass=n.getAttribute("submenuclass")||"submenu",t.__SafeClip=(n.getAttribute("safeclip")||"false").ToBoolean(),t.__Icons=(n.getAttribute("showicons")||"false").ToBoolean(),t.__SafeClip=t.__SafeClip===undefined?n.parentNode.parentNode!==null?n.parentNode.parentNode.$.__SafeClip!==undefined?n.parentNode.parentNode.$.__SafeClip.toString():"true":"true":"true",t.__SafeClip=t.__SafeClip.ToBoolean(),t.Items=new ObservableArray(t),t.IsRoot=!n.parentNode||n.parentNode.tagName!="LI",f=t.Classes.Contains("contextmenu"),o=n,u=n.parentNode,u)while(u.tagName=="MENU"||u.tagName=="LI")o=u,u=u.parentNode;for(t.Root=o.$,t.ParentItem=null,t.__Layout=n.getAttribute("layout")||(t.IsRoot&&!f?MenuLayout.Horizontal:MenuLayout.Vertical),t.Style(Style.PaddingLeft,"0px").Style(Style.Margin,"0px").Style("zoom","1").Style(Style.Display,"inline-block").Style(Style.ListStyleType,"none"),t.__ShowDelegate=new Delegate(t.Show,t),t.__HideDelegate=new Delegate(t.Hide,t,[!0]),t.__HideDelegate2=new Delegate(t.__Hide,t),t.__HideDelegate3=new Delegate(t.Hide,t),t.IsRoot?f?(t.NaturalDisplay="block",Page.OnClick.Add(t.__HideDelegate3),t.Style(Style.ZIndex,NinJaUI.ZIndex++)):t.NaturalDisplay="inline-block":(t.NaturalDisplay="block",t.ParentItem=n.parentNode.$,t.OnMouseOut.Add(t.__HideDelegate2),Page.OnClick.Add(t.__HideDelegate3),t.Style(Style.ZIndex,NinJaUI.ZIndex++)),f||(t.__HideTimer=new Timer(100,!1),t.__ShowTimer=new Timer(100,!1),t.__HideTimer.OnTrigger.Add(new Delegate(t.Hide,t)),t.__ShowTimer.OnTrigger.Add(new Delegate(t.Show,t))),s=Array.From(n.children),h=s.length,e=0;e<h;e++)r=s[e],r.tagName=="LI"&&(r=r.$,r.Classes.Contains("check")?(i=MenuCheckItem.Inherit(MenuCheckItem.Extend(r)),t.IsRoot&&!f&&i.Icon.Collapsed(!0),i.__Submenu||i.OnClick.Add(t.__HideDelegate)):r.Classes.Contains("separator")?(i=new Separator,i.ParentMenu=t,n.replaceChild(i.DOM,r.DOM)):(i=MenuItem.Inherit(MenuItem.Extend(r)),t.IsRoot&&!f&&i.Icon.Collapsed(!0),i.__Submenu||i.OnClick.Add(t.__HideDelegate)),r.Style("display",t.__Layout==MenuLayout.Horizontal?"inline-block":"block").Style("zoom","1"),t.Items.Add(i));t.Items.OnChange.Add(new Delegate(t.__ItemsChanged,t,[Delegate.Event]));t.OnOpening=new Event;t.OnClosing=new Event}function ContextMenu(n){if(n===undefined||n.Type==Type.String)return ContextMenu.Inhert(ContextMenu.Extend(new Element("menu",n).ClassName("contextmenu")));var t=this;t.DOM=n;Menu.Inherit(t,n);t.__ShowDelegate.Function=t.Show;t.__HideDelegate.Function=t.__HideDelegate3.Function=t.Hide;t.__HideDelegate2.Function=t._Hide;t.Style("position", "fixed").Style(Style.ZIndex,NinJaUI.ZIndex++).Collapsed(!0)}function MenuItem(n){var t,r,f,i,u,e;if(this.DOM===undefined)return MenuItem.Inherit(MenuItem.Extend(new ListItem(n)));for(t=this,n=t.DOM,e=n.getAttribute("src")||"",t.__Href=n.getAttribute("href"),t.__Submenu=null,t.__Enabled=(n.getAttribute("enable")||"true").ToBoolean(),t.__Target=n.getAttribute("target")||"",t.__MoreIcon=(new Span).Text("►").Style(Style.Float,"right").Collapsed(!0),n.firstChild||n.appendChild(document.createTextNode("")),t.TextNode=n.firstChild,t.Anchor=(new Anchor).Target(t.__Target).AddElement(t.TextNode),NullOrUndefined(t.__Href)||t.Anchor.Href(t.__Href),t.AddElement(t.Anchor),t.ParentMenu=n.parentNode.$,t.Icon=(new MenuIcon).Source(e),t.ParentMenu.Root.__Icons&&t.InsertElement(0,t.Icon),t.InsertElement(0,t.__MoreIcon),r=Array.From(n.children),f=r.length,i=0;i<f;i++)u=r[i],u.tagName=="MENU"&&t.Submenu(Menu.Inherit(Menu.Extend(u.$)));t.__Enabled||t.Enabled(!1)}function MenuCheckItem(n){var t,i;if(this.DOM===undefined)return MenuCheckItem.Inherit(MenuCheckItem.Extend(new ListItem(n)));t=this;n=this.DOM;MenuItem.Inherit(t,n);t.__Checked=!1;t.OnCheckChanged=new Event;t.OnClick.Add(new Delegate(t.__Toggle,t));i=n.getAttribute("checked");i&&t.Checked(i.ToLower()=="true");n.onselectstart!==undefined?n.onselectstart=function(){return!1}:t.OnClick.Add(function(n){n.Handled=n.CancelEvent=!0})}function MenuIcon(n){if(this.DOM===undefined)return MenuIcon.Inherit(MenuIcon.Extend(new ImageElement(n)));var t=this;t.Width(16).Height(16);t.Visible(!1)}function Separator(n){n===undefined&&(n=document.createElement("hr"));var t=this;t.DOM=n;t.ParentMenu=null}function TagList(n){if(this.DOM===undefined)return TagList.Inherit(TagList.Extend(new TextBox(n)));var t=this;t.Items=new ObservableArray(this);t.Items.OnChange.Add(new Delegate(this.ItemsChanged,this,[Delegate.Event]));t.Container=(new Div).ClassName("taglist");t.ClassName("");t.Parent().InsertElementBefore(t.Container,t).RemoveElement(t);t.OnKeyDown.Add(new Delegate(this.HandleKey,this));t.Container.AddElement(t);t.__O=t.Attribute("layout")=="vertical"?"block":"inline-block";t.__S=(t.Attribute("sortable")||"false").ToBoolean()}function PersistedSection(n){if(this.DOM===undefined)return PersistedSection.Inherit(PersistedSection.Extend(new TextBox(n)));var t=this;t.Params=this.Query("input[type=text], input[type=radio], input[type=checkbox], input[type=hidden], textarea, select");t.Values=Dictionary.FromObject(Client.Storage.Local.GetItem(Page.Href()+"_persist"));Page.OnLoad.Add(new Delegate(this.LoadValues,this))}function SlideShow(n){var u,t,i,f,r;if(this.DOM===undefined)return SlideShow.Inherit(SlideShow.Extend(new Div(n)));for(u=this,this.ClearTextNodes(),this.Slides=new ObservableArray(this),this.__Ef=u.Attribute("effect")||"",i=Array.From(this.DOM.childNodes),f=i.length,t=0;t<f;t++){r=i[t].$;this.Slides.Add(Slide.Inherit(Slide.Extend(r)));switch(this.__EF){default:r.Collapsed(!0)}}this.PreviousSlide=null;this.CurrentSlide=null;this.GoTo(0)}function Slide(n){if(this.DOM===undefined)return Slide.Inherit(Slide.Extend(new Div(n)));this.Collapsed(!0);this.Classes.Add("slide")}function Tree(){if(this.DOM===undefined)return Tree.Inherit(Tree.Extend(new List(e).ClassName("tree")));var t=this.Items,i=t.length,n;for(this.Root=this.Parent().Root||this,n=0;n<i;n++)t[n].Root=this.Root,TreeNode.Inherit(TreeNode.Extend(t[n].ClassName("treenode")));this.__sn=null;this.OnSelectedNodeChanged=new Event}function TreeNode(){if(this.DOM===undefined)return TreeNode.Inherit(TreeNode.Extend(new Div(e).ClassName("treenode")));this.ChildTree=null;this.__sp=(new Span).AddElement(this.DOM.childNodes[0]||"").ClassName("treenodetext");this.InsertElement(0,this.__sp);this.Root=this.Parent().Root;for(var i=Array.From(this.DOM.children),r=i.length,t,n=0;n<r;n++)if(t=i[n],t.tagName=="UL"){this.ChildTree=Tree.Inherit(Tree.Extend(t.$).ClassName("tree"));this.__sp.Classes.Add("parent");this.__sp.OnClick.Add(new Delegate(this.Toggle,this,["Opened"]));this.Opened(this.Attribute("opened")=="true");return}this.OnSelected=new Event;this.__sp.OnClick.Add(new Delegate(this.Selected,this,[!0]));this.__Selected=!1}var NinJaUI={Version:"1.0",ZIndex:1e3},Speed={Slow:400,Normal:200,Fast:100},Alignment={Top:0,Bottom:1,Left:2,Right:3,Center:4,Middle:5},Aspect={Outside:0,Inside:1},Side={Top:1,Bottom:2,Left:4,Right:8,All:15},Direction={Vertical:1,Horizontal:2,Diagonal:3},Effects=LazyEnum({None:"none",Fade:"fade",Slide:"slide",FoldVertical:"foldv",FoldHorizontal:"foldh",FoldBoth:"foldd"}),Edge=LazyEnum({NorthWest:Cursor.NorthWest,SouthEast:Cursor.SouthEast,SouthWest:Cursor.SouthWest,NorthEast:Cursor.NorthEast,North:Cursor.North,West:Cursor.West,South:Cursor.South,East:Cursor.East}),DialogResult,$Dialog,DynamicSizeType,TabLayout,MenuLayout,$TagList;NinJaUI.TextHeight=function(n,t,i){var r=new Span;return t=t||"default",i=i||"default",r.Style("position", "absolute").Style(Style.Padding,"0").Style(Style.Margin,"0").Style(Style.FontFamily,t).Style(Style.FontSize,i+"pt").Text(n),Page.AddElement(r),i=r.Height(),Page.Remove(r),i};NinJaUI.TextWidth=function(n,t,i){var r=new Span;return t=t||"default",i=i||"default",r.Style("position", "absolute").Style(Style.Padding,"0").Style(Style.Margin,"0").Style(Style.FontFamily,t).Style(Style.FontSize,i+"pt").Text(n),Page.AddElement(r),i=r.Width(),Page.Remove(r),i};Animation.prototype.Reverse=function(n){return this.Timer.Stop(),this.Steps=this.__ostep,this.To=this.__ofrom,this.From=this.__oto,this.Animate(n),this};Animation.prototype.Start=function(n){return this.Timer.Stop(),this.Steps=this.__ostep,this.To=this.__oto,this.From=this.__ofrom,this.Animate(n),this};Animation.prototype.Animate=function(n){return this.Element[this.Property](this.From),this.Value=this.From,this.OnFinish=n,this.To.Type!=Type.Array?this.Step=this.From.GetIncrements(this.To,this.Steps):this.Index=0,this.Timer.Start(),this};Animation.prototype.Next=function(){this.Index!==undefined?(this.Index++,this.Index>=this.To.length&&(this.Index=0),this.Value=this.To[this.Index]):this.Value=this.Value.Increment(this.Step);this.Element[this.Property](this.Value);this.Steps--;this.Steps==0&&(this.Element[this.Property](this.To),this.Timer.Stop(),this.OnFinish&&this.OnFinish())};Animation.prototype.Stop=function(){return this.Timer.Stop(),this};Element.prototype.BorderColor=function(n){return this.Style(Style.BorderColor,n)};Element.prototype.FadeOut=function(n,t,i){return n=n||300,t=t||6,new Animation(this,"Opacity",this.Opacity(),0,n,t).Start(i)};Element.prototype.FadeIn=function(n,t,i){return n=n||300,t=t||6,new Animation(this,"Opacity",this.Opacity(),1,n,t).Start(i)};Element.prototype.FadeTo=function(n,t,i,r){return t=t||300,i=i||6,new Animation(this,"Opacity",this.Opacity(),n,t,i).Start(r)};Element.prototype.ToggleFade=function(n,t,i){return n=n||300,t=t||6,this.Opacity()==1?this.FadeOut(n,t,i):this.FadeIn(n,t,i)};Element.prototype.ResizeTo=function(n,t,i,r){return t=t||300,i=i||10,new Animation(this,"Size",this.Size(),n,t,i).Start(r)};Element.prototype.Shrink=function(n,t,i,r){n=n||Direction.Diagonal;t=t||300;i=i||20;var u=this.Size();return n&Direction.Horizontal&&(u.Width=0),n&Direction.Vertical&&(u.Height=0),new Animation(this,"Size",this.Size(),u,t,i).Start(r)};Element.prototype.SlideTo=function(n,t,i,r){return t=t||300,i=i||20,new Animation(this,"Point",this.Point(),n,t,i).Start(r)};Element.prototype.Grow=function(n,t,i,r){var o,e,f,u;return n=n||Direction.Diagonal,t=t||300,i=i||20,o=this.Visible(),e=this.Size(),this.Visible(!1).Style(Style.Width,"").Style(Style.Height,""),f=this.Size(),u=new Size,n==Direction.Horizontal?(u.Width=f.Width,u.Height=this.Height()):n==Direction.Vertical?(u.Height=f.Height,u.Width=this.Width()):(u.Height=f.Height,u.Width=f.Width),this.Size(e).Visible(o),new Animation(this,"Size",e,u,t,i).Start(r)};Element.prototype.ToggleSize=function(n,t,i,r){return this.Width()==0?this.Grow(n,t,i,r):this.Shrink(n,t,i,r)};Element.prototype.BlendBgTo=function(n,t,i,r){t=t||200;i=i||10;n.Type!=Type.Color&&(n=Color.FromRGB(n));var u=this.BackgroundColor();return u.Type!=Type.Color&&(u=Color.FromRGB(u)),new Animation(this,"BackgroundColor",u,n,t,i).Start(r)};Element.prototype.BlendFgTo=function(n,t,i,r){t=t||200;i=i||10;n.Type!=Type.Color&&(n=Color.FromRGB(n));var u=this.BackgroundColor();return u.Type!=Type.Color&&(u=Color.FromRGB(u)),new Animation(this,"ForegroundColor",u,n,t,i).Start(r)};String.prototype.Increment=function(n){return(this.Remove("%").ToInt()+n).ToString()+"%"};String.prototype.GetIncrements=function(n,t){return((n-this.Remove("%").ToFloat())/t).ToInt().ToString("%")};Size.prototype.Increment=function(n){return new Size(this.Width+n.Width,this.Height+n.Height)};Size.prototype.GetIncrements=function(n,t){var i=new Size;return n.Width!==undefined&&(i.Width=(n.Width-this.Width)/t),n.Height!==undefined&&(i.Height=(n.Height-this.Height)/t),i};Point.prototype.Increment=function(n){return new Point(this.X+n.X,this.Y+n.Y)};Point.prototype.GetIncrements=function(n,t){return new Point((n.X-this.X)/t,(n.Y-this.Y)/t)};Number.prototype.Increment=function(n){return this+n};Number.prototype.GetIncrements=function(n,t){return(n-this)/t};Color.prototype.Increment=function(n){return new Color(this.Red+n.Red,this.Green+n.Green,this.Blue+n.Blue)};Color.prototype.GetIncrements=function(n,t){var i=new Color;return i.Red=(n.Red-this.Red)/t,i.Green=(n.Green-this.Green)/t,i.Blue=(n.Blue-this.Blue)/t,i};Element.prototype.Size=function(n){return n===undefined?new Size(this.Width(),this.Height()):(n.Width!==undefined&&this.Width(n.Width),n.Height!==undefined&&this.Height(n.Height),this)};Element.prototype.Point=function(n){return n===undefined?new Point(this.X(),this.Y()):(this.X(n.X).Y(n.Y),this)};Bounds.prototype.Contains=function(n,t){return n.Between(this.Left,this.Right,!0)&&t.Between(this.Top,this.Bottom,!0)};Bounds.prototype.OnEdge=function(n,t,i,r){r=r||1;switch(i){case Edge.North:return t-this.Top<=r;case Edge.NorthWest:return t-this.Top<=r&&n-this.Left<=r;case Edge.West:return n-this.Left<=r;case Edge.SouthWest:return this.Bottom-t<=r&&n-this.Left<=r;case Edge.South:return this.Bottom-t<=r;case Edge.SouthEast:return this.Bottom-t<=r&&this.Right-n<=r;case Edge.East:return this.Right-n<=r;case Edge.NorthEast:return t-this.Top<=r&&this.Right-n<=r}};Element.prototype.GetBounds=function(){return new Bounds(this.X(),this.LayoutWidth()+this.X(),this.Y(),this.LayoutHeight()+this.Y())};Element.prototype.SnapTo=function(n,t,i,r,u,f){var e,h=this.Width(),c=this.Height(),o,s,l,a;if(u=u||0,f=f||0,r=r||0,n==Client?(l=Client.HorizontalScrollPosition(),a=Client.VerticalScrollPosition(),e=new Bounds(l,Client.Width()+l,a,Client.Height()+a)):e=n.GetBounds(),r==0)switch(t){case Side.Left:o=e.Left-h-u;break;case Side.Right:o=e.Right+u;break;case Side.Top:s=e.Top-c-f;break;case Side.Bottom:s=e.Bottom+f}else switch(t){case Side.Left:o=e.Left+u;break;case Side.Right:o=e.Right-h-u;break;case Side.Top:s=e.Top+f;break;case Side.Bottom:s=e.Bottom-c-f}switch(i){case Alignment.Left:o=e.Left+u;break;case Alignment.Right:o=e.Right-h-u;break;case Alignment.Center:o=parseInt((e.Left+e.Right)/2-h/2,10);break;case Alignment.Top:s=e.Top+f;break;case Alignment.Bottom:s=e.Bottom-c-f;break;case Alignment.Middle:s=parseInt((e.Top+e.Bottom)/2-c/2,10)}return this.X(o),this.Y(s),this};Content.prototype.IsClipped=function(n){var i=this.GetBounds(),t;return t=n==Client?new Bounds(0,Client.Width(),0,Client.Height()):n.GetBounds(),t.Left+=Client.HorizontalScrollPosition(),t.Right+=Client.HorizontalScrollPosition(),t.Top+=Client.VerticalScrollPosition(),t.Bottom+=Client.VerticalScrollPosition(),!(i.Left>=t.Left&&i.Right<=t.Right&&i.Top>=t.Top&&i.Bottom<=t.Bottom)};Div.Extensions.Add(new Extension("accordion",Accordion));$Accordion=$AccordionItem=$Anchor;Type.Accordion=Type.$++;Type.AccordionItem=Type.$++;Accordion.prototype.__ItemsChanged=function(n){var r=n.Objects,u=r.length,i,t;switch(n.ModificationType){case ModificationType.Add:for(t=0;t<u;t++)i=r[t],this.AddElements([i.Header,i]),i.ClassName(this.__il).Header.ClassName(this.__hc);break;case ModificationType.Remove:case ModificationType.Clear:for(t=0;t<u;t++)i=r[t],this.RemoveElements([i.Header,i]);break;case ModificationType.Move:case ModificationType.Swap:case ModificationType.Update:for(this.RemoveElements(Array.From(this.DOM.children)),r=this.Items,u=r.length,t=0;t<u;t++)i=r[t],this.AddElements([i.Header,i]),i.ClassName(this.__il).Header.ClassName(this.__hc)}};Accordion.prototype.HeaderClass=function(n){if(n===undefined)return this.__hc;this.__hc=n;for(var i=this.Items,r=i.length,t=0;t<r;t++)i[t].Header.ClassName(n);return this};Accordion.prototype.ItemClass=function(n){if(n===undefined)return this.__il;this.__il=n;for(var i=this.Items,r=i.length,t=0;t<r;t++)i[t].ClassName(n);return this};Accordion.prototype.SelectedClass=function(n){return n===undefined?this.__sc:(this.__sc=n,this.__si&&this.__si.ClassName(n),this)};Accordion.prototype.SelectedItem=function(n){var t=this.__si;return n===undefined?t:(t&&(t.Header.Classes.Remove(this.__sc),t.Collapsed(!0)),t=n,n!==null&&(t.Collapsed(!1),t.Header.Classes.Add(this.__sc)),this.OnSelectionChanged.length>0&&this.OnSelectionChanged.Fire(new EventArgs(this)),this.__si=t,this)};Accordion.prototype.Bind=function(n){return this.Items.BeginUpdate().Clear().AddRange(n).EndUpdate(),this};AccordionItem.prototype=new Div(null);AccordionItem.prototype.constructor=AccordionItem;AccordionItem.prototype.Selected=function(n){var t=this.DOM.parentNode.$;return n===undefined?t.__si==this:n===!0?(t.__si!=this&&t.SelectedItem(this),this):(t.__si==this&&t.SelectedItem(null),this)};Type.DatePicker=Type.$++;$DatePicker=$Anchor;TextBox.Extensions.Add(new Extension("datepicker",DatePicker));DatePicker.ImageIconUrl="";DatePicker.prototype._fd=function(){var n=this.Text();if(!n.IsDate()&&(n.length==6||n.length==8)&&n.IsInt()){var t=n.Substring(0,2).ToInt(),i=n.Substring(2,4).ToInt(),r=n.Substring(4).ToInt();this.SelectedDate(new DateTime(r,t,i))}};DatePicker.prototype.__cm=function(n){var t=this.__M+n;t==0?(t=12,this.__Y--):t==13&&(t=1,this.__Y++);this.__M=t;this.Refresh()};DatePicker.prototype.__dd=function(n){var t=n.Sender.Tag,i=n.Sender;t<0||(this.__D=t,this.__CS&&this.__CS.ClassName(""),this.__CS=i,i.ClassName(this.__sd),this.Text(new DateTime(this.__Y,this.__M,this.__D)),this.Focus(),this.Hide(!0))};DatePicker.prototype.Show=function(){return this.__ui===!1&&this.__fc?(this.__fc=!1,this):this.__dp.Collapsed()?(this.__ui===!0?this.__dp.X(this.__ic.X()).Y(this.__ic.Y()+this.__ic.LayoutHeight()).Collapsed(!1):this.__dp.X(this.X()).Y(this.Y()+this.LayoutHeight()).Collapsed(!1),this):this};DatePicker.prototype.Hide=function(n){return(this.IsFocused||this.__dp.IsMouseOver)&&!n?this:this.__ui===!0&&this.__ic.IsMouseOver?this:this.__dp.Collapsed()?this:(this.__fc=n,this.__dp.Collapsed(!0),this)};DatePicker.prototype.Update=function(){var t=this.Text(),n;return t.IsDate()&&(n=t.ToDateTime(),this.__D=n.Date(),this.__M=n.Month(),this.__Y=n.Year(),this.Refresh()),this};DatePicker.prototype.SelectedDate=function(n){if(n===undefined){var t=this.Text();return t.IsDate()?t.ToDateTime():DateTime.Null}return n==null||n==DateTime.Null?this.Text(""):this.Text(n.ToString()),this.Update(),this};DatePicker.prototype.Refresh=function(){var e;this.__dp.DOM.firstChild.$.Head.Rows[0].Cells[1].Text(DateTime.Months.GetName(this.__M)+" "+this.__Y);for(var f=this.__dp.DOM.firstChild.$.Body,r=1,o=new DateTime(this.__Y,this.__M,1),h=DateTime.Months.GetDays(this.__M,this.__Y)+1,c=DateTime.Days.Sunday,s=o.DayOfWeek(),u,t=f.Rows[r],i=1,l=o.Subtract(new TimeSpan(24*s-c,0)),n=0;n<s;n++)this.__pd?t.Cells[n].Text(l.Date()+n).ClassName(this.__pc).Tag=-1:t.Cells[n].Text("").ClassName(this.__pc).Tag=-1;for(e=!1,u=r;u<7;){for(t=f.Rows[r],t.Collapsed(!1);n<7;n++)if(t.Cells[n].Text(i).ClassName(this.__D==i?this.__sd:"").Tag=i,this.__D==i&&(this.__CS=t.Cells[n]),i++,i>h){e=!0;break}if(e)break;else n=0,u++,r++}for(i=1;u<7;){if(t=f.Rows[r],n==0)t.Collapsed(!0);else for(;n<7;n++,i++)this.__pd?t.Cells[n].Text(i).ClassName(this.__pc).Tag=-1:t.Cells[n].Text("").ClassName(this.__pc).Tag=-1;n=0;u++;r++}};DialogResult=LazyEnum({Ok:0,Cancel:1,Yes:2,No:3});Div.Extensions.Add(new Extension("dialog",Dialog));$Dialog=$Anchor;Dialog.CurrentDialog=null;Dialog.Color="black";Dialog.Opacity=.5;Dialog.ZIndex=1e6;Dialog.Filter=null;Dialog.RemoveCurrent=function(){Dialog.Filter.T.Rows[0].Cells[0].RemoveElement(Dialog.CurrentDialog);Dialog.Dialogs.AddElement(Dialog.CurrentDialog)};Dialog.CloseCurrent=function(n){var t=Dialog.CurrentDialog;t&&(t.Result=n,t.OnDialogClose.Fire(new EventArgs(t,n))!=!1&&(Dialog.RemoveCurrent(),Dialog.Filter.Collapsed(!0),Dialog.Filter.T.Collapsed(!0),Dialog.CurrentDialog=null))};Dialog.prototype.Show=function(){return Dialog.CurrentDialog&&Dialog.RemoveCurrent(),Dialog.CurrentDialog=this,Dialog.Dialogs.RemoveElement(this),Dialog.Filter.Collapsed(!1).T.Collapsed(!1).Rows[0].Cells[0].AddElement(this),this.OnDialogShow.Fire(),this};Dialog.prototype.Hide=function(n){return Dialog.CloseCurrent(n),this};NinJa.OnInitialization.Add(function(){Dialog.Dialogs=(new Div).Collapsed(!0);Page.AddElement(Dialog.Dialogs);Dialog.Filter=(new Div).BackgroundColor(Dialog.Color).Width("100%").Height("100%").Style("position", "fixed").X(0).Y(0).Collapsed(!0);Dialog.Filter.T=(new Table).Width("100%").Height("100%").Style("position", "fixed").X(0).Y(0).Collapsed(!0);Dialog.Filter.T.Rows.Add((new Row).Height("100%"));Dialog.Filter.T.Rows[0].Cells.Add((new Cell).HorizontalAlignment("center").VerticalAlignment("middle").Height("100%"));Dialog.Filter.T.OnClick.Add(Dialog.CloseCurrent);Dialog.Filter.AddElement(Dialog.Dialogs);Dialog.Filter.Opacity(Dialog.Opacity);Page.Form!=undefined?(Page.Form.AddElement(Dialog.Filter),Page.Form.AddElement(Dialog.Filter.T)):(Page.AddElement(Dialog.Filter),Page.AddElement(Dialog.Filter.T))});DynamicSizeType={Static:0,Relative:1,Liquid:2};Anchor.Extensions.Add(new Extension("oneclick",OneClickAnchor));Button.Extensions.Add(new Extension("oneclick",OneClickButton));ContentButton.Extensions.Add(new Extension("oneclick",OneClickContentButton));ImageElement.Extensions.Add(new Extension("rollover",RollOverImage));$RollOverImage=$TextBox;RollOverImage.prototype.Source=function(n){return n===undefined?this.__MOu.Parameters[0]:(this.__MOu.Parameters[0]=n,this.IsMouseOver||(this.src=n),this)};RollOverImage.prototype.HoverSource=function(n){return n===undefined?this.__MOv.Parameters[0]:(this.__MOv.Parameters[0]=n,this.IsMouseOver&&(this.src=n),this)};Type.ScrollBar=Type.$++;Div.Extensions.Add(new Extension("scrollbar",ScrollBar));$ScrollBar=$TextBox;ScrollBar.prototype.ThumbStepValue=function(n){return n===undefined?this.__Tb:(this.__Tb=n,this)};ScrollBar.prototype.__HandleScroll=function(n){this.Value(this.__Value+n.Clicks);n.Handled=!0};ScrollBar.prototype.__HandleTrackClick=function(){var n,t;Event.Current.Handled=!0;this.__Orient=="horizontal"?(n=Mouse.X-this.Track.X(),n<this.TrackThumb.X()?this.Value(this.__Value-this.TrackThumb.LayoutWidth()):this.Value(this.__Value+this.TrackThumb.LayoutWidth())):(t=Mouse.Y-this.Track.Y(),t<this.TrackThumb.Y()?this.Value(this.__Value-this.TrackThumb.LayoutHeight()):this.Value(this.__Value+this.TrackThumb.LayoutHeight()))};ScrollBar.prototype.Width=function(n){return n===undefined?this.__Width(n):(this.__Width(n),this.__RefreshView(),this.MaxValue(this.__MaxValue),this)};ScrollBar.prototype.Height=function(n){return n===undefined?this.__Width(n):(this.__Height(n),this.__RefreshView(),this.MaxValue(this.__MaxValue),this)};ScrollBar.prototype.MaxValue=function(n){if(n==undefined)return this.__MaxValue;var t;return n=n<0?0:n,n?(this.__MaxValue=n,this.__Orient=="horizontal"?(t=this.Track.LayoutWidth()-n,t<8?(this.TrackThumb.Width(8),this.__Step=(this.Track.LayoutWidth()-8)/n):(this.TrackThumb.Width(t),this.__Step=1)):(t=this.Track.LayoutHeight()-n,t<8?(this.TrackThumb.Height(8),this.__Step=(this.Track.LayoutHeight()-8)/n):(this.TrackThumb.Height(t),this.__Step=1)),this.__Value>this.__MaxValue&&(this.__Value=this.__MaxValue)):this.__Step=this.__Value=0,this.Refresh(),this};ScrollBar.prototype.Refresh=function(){this.__Orient=="horizontal"?this.TrackThumb.X(this.__Step*this.__Value):this.TrackThumb.Y(this.__Step*this.__Value)};ScrollBar.prototype.__RefreshView=function(){this.__Orient=="horizontal"?this.Track.Width(this.LayoutWidth()-(this.DecreaseThumb.LayoutWidth()+this.IncreaseThumb.LayoutWidth())):this.Track.Height(this.LayoutHeight()-(this.DecreaseThumb.LayoutHeight()+this.IncreaseThumb.LayoutHeight()))};ScrollBar.prototype.Value=function(n){return n===undefined?this.__Value:(this.__Value=n>this.__MaxValue?this.__MaxValue:n<0?0:n,this.OnScrollChange.Fire(new EventArgs(this,this.__Value)),this.Refresh(),this)};ScrollBar.prototype.Decrease=function(){return Event.Current.Handled=!0,this.Value(this.__Value-this.__Tb),this};ScrollBar.prototype.Increase=function(){return Event.Current.Handled=!0,this.Value(this.__Value+this.__Tb),this};TrackThumb.prototype.CaptureMove=function(){Event.Current.Handled=!0;this.__X=this.X();this.__Y=this.Y();this.TrackDelegate.Enabled=!0;this.Classes.Add("focus")};TrackThumb.prototype.LoseMove=function(){this.TrackDelegate.Enabled=!1;this.Classes.Remove("focus")};TrackThumb.prototype.Move=function(){var n=this.DOM.parentNode.parentNode.$,t,i,r,u;n.__Orient=="horizontal"?(t=this.__X+=Mouse.XChange,i=t/n.__Step,n.Value(i.Round())):(r=this.__Y+=Mouse.YChange,u=r/n.__Step,n.Value(u.Round()))};Div.Extensions.Add(new Extension("rangeslider",RangeSlider));$RangeSlider=$TextBox;RangeSlider.prototype.Refresh=function(){this.RefreshDisplay();this.CheckThumbs();this.OnChange.Fire()};RangeSlider.prototype.RefreshDisplay=function(){var n=this.LowerThumb,t=this.UpperThumb,i=this.RangeThumb;n.X(n.Value()*this.__W+this.X()-n.Width()/2);t.X(t.Value()*this.__W+this.X()-t.Width()/2);i.X(n.X()+n.Width()/2).Width(t.X()+t.Width()/2-i.X());this.__Draw&&this.__Canvas.X(this.X()).Y(this.Height()/2+this.Y()-this.__Canvas.Height()/2-2)};RangeSlider.prototype.Interval=function(n){return n===undefined?this.__Ticks[1]-this.Ticks[0]:this.Steps((this.__max-this.__min)/n)};RangeSlider.prototype.Steps=function(n){return n===undefined?this.__Steps:(this.__Steps=n,this.__F=this.__max/n,this.__W=this.Width()/this.__max,this.__Ticks.Clear(),this.Redraw(),this)};RangeSlider.prototype.Redraw=function(){for(var n=this.__min;n<=this.__max;n+=this.__F)this.__Ticks.push(n),this.__Draw&&(n==this.__max?this.__Canvas.DrawLine(this.__P,new Point((n*this.__W).Round()-1,0),new Point((n*this.__W).Round()-1,this.__H)):this.__Canvas.DrawLine(this.__P,new Point((n*this.__W).Round(),0),new Point((n*this.__W).Round(),this.__H)))};RangeSlider.prototype.MinValue=function(n){return n===undefined?this.__min:(this.__min=n,this.Steps(this.__Steps),this)};RangeSlider.prototype.MaxValue=function(n){return n===undefined?this.__max:(this.__max=n,this.Steps(this.__Steps),this)};RangeSlider.prototype.CheckThumbs=function(){if(this.LowerThumb.Value()>this.UpperThumb.Value()){var n=this.UpperThumb;this.UpperThumb=this.LowerThumb;this.LowerThumb=n}};RangeSliderThumb.prototype.CaptureMove=function(){Event.Current.Handled=!0;this.__X=this.X();this.__Y=this.Y();this.TrackDelegate.Enabled=!0;this.Classes.Add("focus");Page.Cursor("ew-resize")};RangeSliderThumb.prototype.LoseMove=function(){this.TrackDelegate.Enabled=!1;this.Classes.Remove("focus");Page.Cursor(Cursor.Default)};RangeSliderThumb.prototype.Move=function(){var n=this.Parent(),i,t,r,u;n.__Orient=="horizontal"?(i=this.__X+=Mouse.XChange,this==n.RangeThumb?(t=n.UpperThumb.__Value-n.LowerThumb.__Value,n.LowerThumb.Value((i-n.X())/n.__W),n.UpperThumb.Value(n.LowerThumb.__Value+t),n.UpperThumb.__Value-n.LowerThumb.__Value<t&&n.LowerThumb.Value(n.UpperThumb.__Value-t)):this.Value((i-n.X())/n.__W)):(r=this.__Y+=Mouse.YChange,u=r/n.__Step,n.Value(u.Round()))};RangeSliderThumb.prototype.Value=function(n){var t=this.Parent();return n===undefined?this.__Value:(this.__Value=t.__Ticks.FindNearest(n),t.Refresh(),this)};$SuggestionBox=$TextBox;TextBox.Extensions.Add(new Extension("suggestion",SuggestionBox));SuggestionBox.prototype.__MuffleClick=function(){Event.Current.Handled=!0};SuggestionBox.prototype.Header=function(n){return n===undefined?this.__Header:(this.__Header=n,this.__h.Collapsed(n.length==0).Text(this.__Header),this)};SuggestionBox.prototype.__CheckCache=function(){for(var n;this.Data.length>this.__AnchorCache.length;)n=(new Anchor).Style(Style.Display,"block").Underline(!1),n.OnClick.Add(new Delegate(this.__SelectData,this,[n])),this.__AnchorCache.Add(n)};SuggestionBox.prototype.__HandleKeyDown=function(n){n=$KeyEventArgs(n);switch(n.Key){case Keys.Enter:case Keys.Tab:this.__CurrentAnchor&&(this.SelectedData(this.__CurrentAnchor.Tag),n.Handled=!0,this.Blur());break;case Keys.DownArrow:this.__dp.Collapsed()&&this.ShowSuggestions();this.__hiNext();break;case Keys.UpArrow:this.__dp.Collapsed()&&this.ShowSuggestions();this.__hiPrevious()}};SuggestionBox.prototype.__HandleKeyUp=function(n){if(this.__StopShow){this.__StopShow=!1;return}n&&(n.Key==Keys.UpArrow||n.Key==Keys.DownArrow)||(this.Text().length>=this.__MinLength?(this.Update(),this.Data.length>0?this.ShowSuggestions():this.HideSuggestions(!0)):(this.Bind([]),this.HideSuggestions(!0)))};SuggestionBox.prototype.__SelectData=function(n){this.SelectedData(n.Tag)};SuggestionBox.prototype.SelectedData=function(n){var t;return n===undefined?this.__sdData:(this.__sdData=n,n==null?this.Clear():(t=NinJa.EvalBind(this.__SText,n),t!==undefined&&this.Text(t)),this.OnSuggestionSelected.Fire(new EventArgs(this,n)),this.HideSuggestions(!0),this)};SuggestionBox.prototype.__hiNext=function(){if(!this.__dp.Collapsed()){this.__CurrentAnchor&&(this.__FocusClass?this.__CurrentAnchor.Classes.Remove(this.__FocusClass):this.__CurrentAnchor.BackgroundColor("").ForegroundColor(""));var n=this.__CurrentAnchors.IndexOf(this.__CurrentAnchor);n++;n>=this.__CurrentAnchors.length?n=0:n==-1&&(n=0);this.__CurrentAnchor=this.__CurrentAnchors[n];this.__FocusClass?this.__CurrentAnchor.Classes.Add(this.__FocusClass):this.__CurrentAnchor.BackgroundColor("#3399ff").ForegroundColor("#ffffff");this.__dp.IsClipped(this.__CurrentAnchor)&&this.__dp.VerticalScrollToElement(this.__CurrentAnchor)}};SuggestionBox.prototype.__hiPrevious=function(){if(!this.__dp.Collapsed()){this.__CurrentAnchor&&(this.__FocusClass?this.__CurrentAnchor.Classes.Remove(this.__FocusClass):this.__CurrentAnchor.BackgroundColor("").ForegroundColor(""));var n=this.__CurrentAnchors.IndexOf(this.__CurrentAnchor);n--;n<0&&(n=this.__CurrentAnchors.length-1);this.__CurrentAnchor=this.__CurrentAnchors[n];this.__FocusClass?this.__CurrentAnchor.Classes.Add(this.__FocusClass):this.__CurrentAnchor.BackgroundColor("#3399ff").ForegroundColor("#ffffff");this.__dp.IsClipped(this.__CurrentAnchor)&&this.__dp.VerticalScrollToElement(this.__CurrentAnchor)}};SuggestionBox.prototype.DisplayClass=function(n){return n===undefined?this.__dp.ClassName():(this.__dp.ClassName(n),n?this.__dp.Style(Style.Border,"").BackgroundColor(Colors.Empty).Style(Style.Padding,""):this.__dp.Style(Style.Border,"1px solid #000000").BackgroundColor(Colors.White).Height(200),this)};SuggestionBox.prototype.FocusClass=function(n){return n===undefined?this.__FocusClass:(this.__FocusClass=n,this)};SuggestionBox.prototype.Source=function(n){return n===undefined?this.__Source:(this.__Source=n,this)};SuggestionBox.prototype.MinLength=function(n){return n===undefined?this.__MinLength:(this.__MinLength=n,this)};SuggestionBox.prototype.ShowSuggestions=function(){return this.__StopShow||this.Data.length>0&&(this.__dp.X(this.X()).Y(this.Y()+this.LayoutHeight()),this.__dp.Width("").Collapsed(!1).Width(this.__dp.LayoutWidth()+17)),this.__StopShow=!1,this};SuggestionBox.prototype.HideSuggestions=function(n){return n===undefined&&(this.__dp.IsMouseOver||this.IsFocused||this.IsMouseOver)?this:(this.__dp.Collapsed(!0),this)};SuggestionBox.prototype.Update=function(){var n;return this.__Source&&(n=this.__Source(this.Text()),n&&this.Bind(n)),this.__CurrentAnchor&&(this.__FocusClass?this.__CurrentAnchor.Classes.Remove(this.__FocusClass):this.__CurrentAnchor.BackgroundColor("").ForegroundColor(""),this.__CurrentAnchor=null),this};SuggestionBox.prototype.Bind=function(n){return this.Data.BeginUpdate(),this.Data.Clear(),this.Data.AddRange(n),this.Data.EndUpdate(),this.__CheckCache(),this.Refresh(),this.ShowSuggestions(),this};SuggestionBox.prototype.BindText=function(n){return n===undefined?this.__Text:(this.__Text=n,this)};SuggestionBox.prototype.BindValue=function(n){return n===undefined?this.__Value:(this.__Value=n,this)};SuggestionBox.prototype.Refresh=function(){var r,u,n,i,t;for(this.__dp.RemoveElements(this.__CurrentAnchors),this.__CurrentAnchors.Clear(),r=this.Data.length,u=this.Data,t=0;t<r;t++)i=u[t],n=this.__AnchorCache[t],n.Classes.Clear(),n.Content(NinJa.EvalBind(this.__Text,i)||""),n.Tag=i,this.__dp.AddElement(n),this.__CurrentAnchors.Add(n)};$Template=$Anchor;Type.Template=Type.$++;Div.Extensions.Add(new Extension("template",Template));Template.prototype.TemplateNode=function(n){this.RemoveElements(Array.From(this.DOM.childNodes));this.AddElement(n);this.Init()};Template.prototype.Init=function(){var t=this.__al=NinJaUI.__GetBindableNodes(this.DOM,[]),i=t.length,n;for(this.__tp=[],n=0;n<i;n++)this.__tp.push(t[n].nodeValue)};Template.prototype.Bind=function(n){var r,u,i,f,t;for(n=n||{},this.__tp===undefined&&this.Init(),i=this.__tp,f=i.length,t=0;t<f;t++)r=i[t],u=this.__al[t],u.nodeValue=String.BindFormat(r,n);return this.Tag=n,this.BindData(n),this.RefreshChildren(),this};Div.Extensions.Add(new Extension("templatelist",TemplateList));Type.TemplateList="TemplateList";$TemplateList=$Anchor;TemplateList.prototype.Bind=function(n){return this.Items.BeginUpdate().Clear().AddRange(n).EndUpdate(),this};TemplateList.prototype.Commit=function(){for(var e=Array.From(this.DOM.childNodes).RemoveAt(0),o=e.length,u,t,i,f,n,r=0;r<o;r++){u=e[r].$.BuildObjectFromBinding();i=this.Items[r];for(t in u)if(f=i[t],n=u[t],f!==undefined)switch(f.Type){case Type.DateTime:i[t]=n.IsDate()?n.ToDateTime():DateTime.Null;break;case Type.Number:i[t]=n.IsInt()?n.ToInt():n.IsFloat()?n.ToFloat():0;break;default:i[t]=n}else i[t]=n}return this};TemplateList.prototype.Loading=function(n){return this.Items.Clear(),this.EmptyText.Text(n||"Loading..."),this};TemplateList.prototype.Refresh=function(){for(var t=Array.From(this.DOM.childNodes).RemoveAt(0),i=t.length,n=0;n<i;n++)t[n].$.Bind(this.Items[n]);return this};TemplateList.prototype.ItemsChanged=function(n){var i,r=n.Objects,u=r.length,t;switch(n.ModificationType){case ModificationType.Add:for(t=0;t<u;t++)i=new Template,i.TemplateNode(NinJa.CloneNode(this.__Template)),this.AddElement(i),r[t].__Index=t+n.Index,NinJa.WrapObjects(i.DOM),i.Bind(r[t]),this.__S&&i.MakeDraggable();break;case ModificationType.Clear:case ModificationType.Remove:for(t=u-1;t>=0;t--)this.RemoveElementAt(n.Index+t+1);break;case ModificationType.Move:case ModificationType.Swap:case ModificationType.Update:for(u=this.DOM.childNodes.length-1,t=u-1;t>=0;t--)this.RemoveElementAt(n.Index+t+1);for(u=r.length,t=0;t<u;t++)i=new Template,i.TemplateNode(NinJa.CloneNode(this.__Template)),this.AddElement(i),NinJa.WrapObjects(i.DOM),r[t].__Index=t,i.Bind(r[t]),this.__S&&i.MakeDraggable()}this.EmptyText.Collapsed(this.Items.length!==0).Text("No items.")};Template.prototype.MakeDraggable=function(){var n,t,i,r;if(this.__M=new Delegate(this.MoveItem,this),Page.OnMouseMove.Add(this.__M),n=this.ElementsByClassName("handle"),i=new Delegate(this.GrabItem,this),n.length>0)for(r=n.length,t=0;t<r;t++)n[t].OnMouseDown.Add(i);else this.OnMouseDown.Add(i);this.__N=new Delegate(this.DropItem,this);this.__N.Enabled=this.__M.Enabled=!1;Page.OnMouseUp.Add(this.__N)};Template.prototype.GrabItem=function(){Event.Current.Handled=!0;this.__N.Enabled=this.__M.Enabled=!0;this.__X=Mouse.X;this.__Y=Mouse.Y;this._X=this.X();this._Y=this.Y();this.__BB=(new Div).Size(new Size(this.LayoutWidth(),this.LayoutHeight()));this.Width(this.LayoutWidth()).Height(this.LayoutHeight());this.Style("position", "absolute").X(this._X).Y(this._Y);this.Parent().InsertElementBefore(this.__BB,this);Page.Cursor(Cursor.Move)};Template.prototype.MoveItem=function(){this.X(this._X+(Mouse.X-this.__X));this.Y(this._Y+(Mouse.Y-this.__Y));for(var i=this.Parent(),u=Array.From(i.DOM.childNodes),e=u.length,n,o=Mouse.X,r,f=this.GetBounds(),s=f.Bottom,t=0;t<e;t++)n=u[t].$,r=n.GetBounds(),r.Contains(o,s)&&n!==this&&n!==this.__BB&&(f.Middle<r.Middle?i.InsertElementBefore(this.__BB,n):i.InsertElementAfter(this.__BB,n))};Template.prototype.DropItem=function(){var n=this.Parent(),t,r,u,i;for(this.__N.Enabled=this.__M.Enabled=!1,this.Style("position", "static"),Page.Cursor(Cursor.Default),n.RemoveElement(this).InsertElementAfter(this,this.__BB).RemoveElement(this.__BB),t=n.Items,t.BeginUpdate().Clear(),r=Array.From(n.DOM.childNodes),u=r.length,i=1;i<u;i++)t.push(r[i].$.Tag);t.EndUpdate();n.OnSorted.length>0&&n.OnSorted.Fire(new EventArgs(n,n.Items))};Table.Extensions.Add(new Extension("templatelist",TemplateTableList));Type.TemplateList="TemplateList";$TemplateTableList=$Anchor;TemplateTableList.prototype.Bind=function(n){return this.Items.BeginUpdate().Clear().AddRange(n).EndUpdate(),this};TemplateTableList.prototype.Loading=function(n){return this.Items.Clear(),this.EmptyText.Text(n||"Loading..."),this};TemplateTableList.prototype.Refresh=function(){for(var t=Array.From(this.Rows),i=this.Items.length,n=0;n<i;n++)t[n].Bind(this.Items[n])};TemplateTableList.prototype.ItemsChanged=function(n){var i,r=n.Objects,u=r.length,t;this.Rows.Remove(this.EmptyRow);switch(n.ModificationType){case ModificationType.Add:for(t=0;t<u;t++)i=new TemplateRow(NinJa.CloneNode(this.__Template)),this.Rows.Insert(n.Index+t,i),r[t].__Index=t+n.Index,NinJa.WrapObjects(i.DOM),i.Bind(r[t]).BindData(r[t]);break;case ModificationType.Clear:this.Rows.Clear();break;case ModificationType.Remove:for(t=u-1;t>=0;t--)this.Rows.RemoveAt(n.Index+t);break;case ModificationType.Update:for(this.Rows.Clear(),t=0;t<u;t++)i=new TemplateRow(NinJa.CloneNode(this.__Template)),this.Rows.Insert(n.Index+t,i),r[t].__Index=t,NinJa.WrapObjects(i.DOM),i.Bind(r[t]).BindData(r[t])}this.Items.length==0&&(this.Rows.Add(this.EmptyRow),this.EmptyText.Text("No items"))};TemplateTableList.prototype.Commit=function(){for(var e=this.Rows,o=e.length,u,t,i,f,n,r=0;r<o;r++){u=e[r].BuildObjectFromBinding();i=this.Items[r];for(t in u)if(f=i[t],n=u[t],f!==undefined)switch(f.Type){case Type.DateTime:i[t]=n.IsDate()?n.ToDateTime():DateTime.Null;break;case Type.Number:i[t]=n.IsInt()?n.ToInt():n.IsFloat()?n.ToFloat():0;break;default:i[t]=n}else i[t]=n}return this};$TemplateRow=$Anchor;Type.TemplateRow=Type.$++;Row.Extensions.Add(new Extension("template",Template));TemplateRow.prototype.Bind=function(n){var r,i,u,f,e,t;if(n=n||{},!this.Template)for(this.Template=!0,this.__all=NinJaUI.__GetBindableNodes(this.DOM,[]),this.__nodeValues=[],r=this.__all.length,i=0;i<r;i++)this.__nodeValues.push(this.__all[i].nodeValue);for(e=this.__all.length,t=0;t<e;t++)u=this.__nodeValues[t],f=this.__all[t],f.nodeValue=String.BindFormat(u,n);return this.Tag=n,this};NinJaUI.__GetBindableNodes=function(n,t){for(var u,o,r,e=Array.From(n.childNodes),s=e.length,i,f=0;f<s;f++)if(i=e[f],i.nodeName!="#text")if(i.getAttribute("nobind")=="true")i.parentNode.removeChild(i);else{for(u=i.attributes,o=u.length,r=0;r<o;r++)String.BindRegEx.exec(u[r].value)&&t.push(u[r]);NinJaUI.__GetBindableNodes(i,t)}else String.BindRegEx.exec(i.nodeValue)&&t.push(i),NinJaUI.__GetBindableNodes(i,t);return t};TextBox.Extensions.Add(new Extension("watermark",WaterMarkTextBox));$WaterMarkTextBox=$TextBox;WaterMarkTextBox.prototype.__CheckValue=function(){this.__Overlay.Collapsed(this.Text().length>0)};WaterMarkTextBox.prototype.WaterMarkValue=function(n){return n===undefined?this.__WaterMarkValue:(this.__WaterMarkValue=n,this.__CheckValue(),this)};$CheckBoxList=$TextBox;Span.Extensions.Add(new Extension("checkboxlist",CheckBoxList));Type.CheckBoxList=Type.$++;CheckBoxList.prototype.BindData=function(n){n=NinJa.EvalBind(this.__bp,n);n!==undefined&&this.SelectedValue(n)};CheckBoxList.prototype.Bind=function(n){for(var u=this.Items.BeginUpdate().Clear(),f=n.length,i,r,t=0;t<f;t++)i=n[t],r=new CheckBoxListItem,r.Text(i[this.__bt]).Value(i[this.__bv]),r.Tag=i,u.push(r);return u.EndUpdate(),this};CheckBoxList.prototype.__UpdateItems=function(n){var f=n.Objects,u=f.length,t,i=this,r;this.SelectedItems.BeginUpdate();switch(n.ModificationType){case ModificationType.Add:for(i.AddElements(n.Objects),t=0;t<u;t++)n.Objects[t].Parent=this,n.Objects[t].Selected()&&this.SelectedItems.Add(n.Objects[t]);break;case ModificationType.Clear:case ModificationType.Remove:i.RemoveElements(n.Objects);i.SelectedItems.RemoveRange(n.Objects);break;case ModificationType.Update:for(i.RemoveElements(Array.From(i.DOM.childNodes)),i.AddElements(n.Objects),i.SelectedItems.Remove(n.Objects),t=0;t<u;t++)r=n.Objects[t],r.Parent=i,r.Selected()&&i.SelectedItems.Add(r)}this.SelectedItems.EndUpdate(!1)};CheckBoxList.prototype.__SelectedItemsChanged=function(n){for(var i=n.Sender.Owner,u=i.SelectedItems,r=i.Items,f=r.length,t=0;t<f;t++)r[t].__Updating=!0,r[t].Selected(u.Contains(r[t])),r[t].__Updating=!1;i.OnSelectionChanged.Fire(new EventArgs(i,i.SelectedItems))};CheckBoxList.prototype.__ItemChanged=function(n){var t=this;t.__Updating||(t.__Updating=!0,n.Selected()?t.SelectedItems.Add(n):t.SelectedItems.Remove(n),t.__Updating=!1,t.OnSelectionChanged.Fire(new EventArgs(t,t.SelectedItems)))};CheckBoxList.prototype.Value=CheckBoxList.prototype.SelectedValue=function(n){if(n===undefined){for(var i="",r=this.SelectedItems,o=r.length,t=0;t<o;t++)i+=i.length==0?r[t].Value():","+r[t].Value();return i}n=n.ToLower().Split(",");this.SelectedItems.BeginUpdate().Clear();for(var e=this.Items,s=e.length,u=0,f;u<s;u++)f=e[u],f.Selected(n.Contains(f.Value().ToLower().Trim()));return this.SelectedItems.EndUpdate(),this};CheckBoxList.prototype.SelectedValues=function(n){if(n===undefined){for(var u=[],f=this.SelectedItems,o=f.length,t=0;t<o;t++)u.Add(f[t].Value());return u}this.SelectedItems.BeginUpdate().Clear();for(var e=this.Items,s=e.length,i=0,r;i<s;i++)r=e[i],r.Selected(n.Contains(r.Value().ToLower().Trim()));this.SelectedItems.EndUpdate()};CheckBoxListItem.IdGen=0;CheckBoxListItem.prototype.Selected=CheckBox.prototype.Checked;CheckBoxListItem.prototype.Content=function(n){return n===undefined?this.__lb.Content():(this.__lb.Content(n),this)};CheckBoxListItem.prototype.Text=function(n){return n===undefined?this.__lb.Text():(this.__lb.Text(n),this)};CheckBoxListItem.prototype.Value=function(n){return n===undefined?this.__cb.DOM.value:(this.__cb.DOM.value=n,this)};CheckBoxListItem.prototype.Selected=function(n){return n===undefined?this.__cb.Checked(n):(this.__cb.Checked(n),this)};CheckBoxListItem.prototype.__np=function(){if(!this.__Updating&&!NullOrUndefined(this.Parent)){var n=this.Parent.SelectedItems;n.BeginUpdate();this.Selected()?n.Add(this):n.Remove(this);n.EndUpdate(!1)}};Div.Extensions.Add(new Extension("floatbox",FloatBox));FloatBox.prototype.CheckFloatMode=function(){this.Style(Style.Position)=="fixed"?Client.VerticalScrollPosition()<=this.__OY&&this.Style(Style.Position,""):(this.__OY=this.Y(),this.__OW=this.Width(),Client.VerticalScrollPosition()>this.Y()&&this.Style(Style.Position,"fixed").Y(0).Width(this.__OW))};$Tab=$TabItem=$TextBox;Type.Tab=Type.$++;Type.TabHeader=Type.$++;Type.TabItem=Type.$++;Div.Extensions.Add(new Extension("tab",Tab));TabLayout={Top:"top",Bottom:"bottom",Left:"left",Right:"right"};Tab.prototype.Update=function(){this.Header.ClearContent();this.Container.ClearContent();for(var i=this.TabItems,r=i.length,t,n=0;n<r;n++)t=i[n],this.Container.AddElement(t),this.Header.AddElement(t.Header)};Tab.prototype.SelectedItem=function(n){return n===undefined?this.__si:n==this.__si?this:(this.__si&&(this.__si.Header.Classes.Remove("selected"),this.__si.Collapsed(!0)),this.__si=n,this.__si.Header.Classes.Add("selected"),this.__si.Collapsed(!1),this.OnSelectionChanged.length>0&&this.OnSelectionChanged.Fire(new EventArgs(this,this.__si)),n.OnSelected.length>0&&n.OnSelected.Fire(new EventArgs(n)),this)};Tab.prototype.SelectedIndex=function(){return this.TabItems.IndexOf(this.SelectedItem())};Tab.prototype.TabLocation=function(n){var t,r,u,i;if(n===undefined)return this.__TabLocation;this.__TabLocation=n;this.RemoveElements([this.Header,this.Container]);this.Header.Style("vertical-align","top");switch(n){case"top":this.AddElements([this.Header,this.Container]);t="inline-block";break;case"bottom":this.AddElements([this.Container,this.Header]);t="inline-block";break;case"left":this.Container.Style(Style.Display,"inline-block").Style("vertical-align","top").NaturalDisplay="inline-block";this.AddElements([this.Header,this.Container]);t="block";break;case"right":this.Container.Style(Style.Display,"inline-block").Style("vertical-align","top").NaturalDisplay="inline-block";this.AddElements([this.Container,this.Header]);t="block"}for(r=this.TabItems,u=r.length,i=0;i<u;i++)r[i].Header.Style(Style.Display,t).NaturalDisplay=t};TabItem.prototype.Enabled=function(n){return n===undefined?this.__Enabled:(this.__OEnabled(n),this.Header.Enabled(n),this)};TabItem.prototype.Selected=function(n){var t=this.DOM.parentNode.parentNode.$;if(!t)return this;if(n===undefined)return this==t.__si;n===!0?t.__si!=this&&t.SelectedItem(this):t.__si==this&&t.SelectedItem(null)};TabItem.prototype.Shown=function(n){return n===undefined?!this.Header.Collapsed():(this.Selected()&&this.Collapsed(!n),this.Header.Collapsed(!n),this)};Type.MenuItem=Type.$++;Type.Menu=Type.$++;Type.ContextMenu=Type.$++;Type.MenuCheckItem=Type.$++;Type.MenuIcon=Type.$++;NinJa.Mapper.Add("MENU",List);List.Extensions=[new Extension("menu",Menu),new Extension("contextmenu",ContextMenu)];MenuLayout={Vertical:"vertical",Horizontal:"horizontal"};$MenuCheckItem=$ContextMenu=$Menu=$MenuItem=$Anchor;Menu.prototype=new Content(null);Menu.prototype.constructor=Menu;ContextMenu.__Current=null;ContextMenu.prototype.__ItemsChanged=Menu.prototype.__ItemsChanged=function(n){var i=n.Sender.Owner.DOM,e=n.Objects,h=e.length,o=Array.From(i.children),c=o.length,u,s,f,r,t;switch(n.ModificationType){case ModificationType.Add:for(r=0;r<h;r++)t=e[r],n.Index>=c?i.$ap(t.DOM):i.$ib(t.DOM,o[n.Index++]),t.Icon.Collapsed(this.IsRoot),t.ParentMenu=this,t.Style(Style.Display,this.__Layout!=MenuLayout.Vertical?"inline-block":"block").Style("zoom","1"),t.Type!=Type.Separator&&t.OnClick.Add(this.__HideDelegate);break;case ModificationType.Remove:case ModificationType.Clear:for(r=0;r<h;r++)t=e[r],i.$rc(t.DOM),t.ParentMenu=null,t.Type!=Type.Separator&&t.OnClick.Remove(this.__HideDelegate);break;case ModificationType.Update:for(r=0;r<c;r++)t=o[r],i.$rc(t.DOM),t.ParentMenu=null,t.Icon.Collapsed(this.IsRoot),t.Type!=Type.Separator&&t.OnClick.Remove(this.__HideDelegate);for(r=0;r<h;r++)t=e[r],i.$ap(t.DOM),t.ParentMenu=this,t.Style(Style.Display,this.__Layout!=MenuLayout.Vertical?"inline-block":"block").Style("zoom","1"),t.Type!=Type.Separator&&t.OnClick.Add(this.__HideDelegate);break;case ModificationType.Swap:u=e[0].DOM;s=e[1].DOM;f=document.createTextNode("beep");i.$ib(f,u);i.$.$rc(u);i.$ib(u,s);i.$.$rc(s);i.$ib(s,f);i.$.$rc(f);delete f;break;case ModificationType.Move:u=e[0].DOM;f=document.createTextNode("meep");i.$ib(f,u);i.$rc(u);n.Index>=c?i.$ap(u):i.$ib(u,o[n.Index]);i.$rc(f);delete f}};Menu.prototype.__Show=function(){this.__ShowTimer.Stop();this.__HideTimer.Stop();this.ParentItem.ParentMenu&&this.ParentItem.ParentMenu.__HideTimer&&this.ParentItem.ParentMenu.__HideTimer.Stop();this.__ShowTimer.Start()};Menu.prototype.__Hide=function(){this.__HideTimer.Stop();this.__ShowTimer.Stop();this.__HideTimer.Start()};Menu.prototype.Show=function(){this.Collapsed()&&(this.ParentItem.ParentMenu.IsRoot&&this.ParentItem.ParentMenu.__Layout!="vertical"?this.X(this.ParentItem.X()).Y(this.ParentItem.Y()+this.ParentItem.LayoutHeight()):this.X(this.ParentItem.X()+this.ParentItem.LayoutWidth()).Y(this.ParentItem.Y()),this.OnOpening.Fire(new EventArgs(this))&&(this.Visible(!1).Collapsed(!1),this.__SafeClip&&this.IsClipped(Client)&&(this.ParentItem.ParentMenu.IsRoot?this.SnapTo(this.ParentItem,Side.Bottom,Alignment.Right,Aspect.Outside):this.SnapTo(this.ParentItem,Side.Left,Alignment.Top,Aspect.Outside)),this.Visible(!0).Collapsed(!1),this.ParentItem.Classes.Contains("active")||this.ParentItem.Classes.Add("active")))};Menu.prototype.Hide=function(n){this.Collapsed()||this.IsRoot||(this.IsMouseOver||this.ParentItem.IsMouseOver)&&!n||(n||!Menu.CheckChildren(this))&&(this.OnClosing.Fire(new EventArgs(this))&&(this.Collapsed(!0),this.ParentItem.ParentMenu.IsRoot||this.ParentItem.ParentMenu.Hide(n)),this.ParentItem.Classes.Remove("active"))};Menu.CheckChildren=function(n){for(var r=n.Items,u=r.length,i,t=0;t<u;t++)if(i=r[t],i.__Submenu&&(i.__Submenu.IsMouseOver||Menu.CheckChildren(i.__Submenu)))return!0;return!1};Menu.prototype.Layout=function(n){if(n===undefined)return this.__Layout;this.__Layout=n;for(var i=this.Items,r=i.length,t=0;t<r;t++)i[t].Style(Style.Display,n==MenuLayout.Horizontal?"inline-block":"block").Style("zoom","1")};ContextMenu.prototype.Show=function(){var n=Event.Current;this.X(Mouse.ClientX+2);this.Y(Mouse.ClientY+2);this.OnOpening.Fire(new EventArgs(this))&&(this.Visible(!1).Collapsed(!1),this.__SafeClip&&(this.IsClipped(Client)&&this.SnapTo(Client,Side.Right),this.IsClipped(Client)&&this.SnapTo(Client,Side.Bottom)),this.Visible(!0).Collapsed(!0));ContextMenu.__Current&&ContextMenu.__Current!=this&&ContextMenu.__Current.Hide(!0);ContextMenu.__Current=this;n.CancelEvent=!0;n.Handled=!0};ContextMenu.prototype.Hide=function(n){this.Collapsed()||(this.IsMouseOver||(this.ParentItem?this.ParentItem.IsMouseOver:!1))&&!n||(n||!Menu.CheckChildren(this))&&(this.OnClosing.Fire(new EventArgs(this))&&(this.Collapsed(!0),this.ParentItem&&this.ParentItem.ParentMenu.Hide(n)),ContextMenu.__Current=null)};MenuItem.prototype=new Content(null);MenuItem.constructor=MenuItem;MenuCheckItem.prototype=new Content(null);MenuCheckItem.constructor=MenuCheckItem;MenuCheckItem.prototype.Enabled=MenuItem.prototype.Enabled=function(n){return n===undefined?this.__Enabled:(this.__Enabled=n,this.__Submenu&&(this.__ParentMenu.IsRoot||this.__ParentMenu.__Layout!="vertical"||this.__MoreIcon.Collapsed(!n),this.__SubmenuDel.Enabled=n),this.Opacity(this.__Enabled?1:.5),this)};MenuCheckItem.prototype.Text=MenuItem.prototype.Text=function(n){return n===undefined?this.TextNode:(this.TextNode.nodeValue=n,this)};MenuCheckItem.prototype.Submenu=MenuItem.prototype.Submenu=function(n){var i=this.__Submenu,t;return n===undefined?this.__Submenu:(i&&(i.Classes.Remove(i.Root.__ChildClass),this.OnClick.Remove(i.__ShowDelegate)),n.ParentItem&&(t=n.ParentItem,t.OnMouseOver.Remove(t.__SubmenuDel),t.OnMouseOut.Remove(n.__HideDelegate2),t.OnClick.Remove(n.__ShowDelegate),t.OnMouseOver.Remove(n.ParentItem.__SubmenuDel)),this.__Submenu=n,n?(this.ParentMenu.IsRoot||this.ParentMenu.__Layout!="vertical"||this.__MoreIcon.Collapsed(!1),n.ParentItem=this,n.Style("position", "absolute"),n.Collapsed(!0),n.Root=this.ParentMenu.Root,n.IsRoot=!1,n.Classes.Add(n.Root.__ChildClass),n.Layout(MenuLayout.Vertical),Page.AddElement(n),this.__SubmenuDel=new Delegate(n.__Show,n),this.OnMouseOver.Add(this.__SubmenuDel),this.OnMouseOut.Add(n.__HideDelegate2),this.OnClick.Add(n.__ShowDelegate),n.Collapsed(!0),n.IsRoot=!1,n.Root=this.ParentMenu.Root,n.Items.ForEach(function(n){n.Icon&&n.Icon.Collapsed(!1)})):(this.__MoreIcon.Collapsed(!0),this.OnClick.Add(this.ParentMenu.__HideDelegate)),this)};MenuCheckItem.prototype.__Toggle=function(){this.Checked(!this.__Checked)};MenuCheckItem.prototype.Checked=function(n){return n===undefined?this.__Checked:(this.__Checked=n,this.Icon.Visible(this.__Checked),this.OnCheckChanged.Fire(new EventArgs(this)),this)};Element.prototype.ContextMenu=function(n){this.__CurrentContextMenu&&this.OnContextMenu.Remove(this.__CurrentContextMenu.__ShowDelegate);this.__CurrentContextMenu=n;this.OnContextMenu.Add(this.__CurrentContextMenu.__ShowDelegate)};MenuIcon.prototype=new ImageElement(null);MenuIcon.constructor=MenuIcon;MenuIcon.prototype.Source=function(n){return n==undefined?this.src:(this.src=n,this.Visible(!String.IsNullOrEmpty(n)),this)};Type.Separator="Separator";Separator.prototype.Collpased=Element.prototype.Collapsed;Separator.prototype.Visible=Element.prototype.Visible;Separator.prototype.Style=Element.prototype.Style;TextBox.Extensions.Add(new Extension("taglist",TagList));$TagList=$TextArea;TagList.prototype.HandleKey=function(){var n=Event.Current,t=n.Key;switch(t){case Keys.Enter:case Keys.Tab:n.Handled=this.AddItem(this.Text());this.Clear();break;case Keys.Delete:case Keys.Backspace:this.Text().length==0&&this.RemoveItem(this.Items.Last())}};TagList.prototype.AddItem=function(n){return n.length==0?!1:(this.Items.Contains(n)&&this.Items.Remove(n),this.Items.Add(n),!0)};TagList.prototype.RemoveItem=function(n){return this.Items.Remove(n),this};TagList.prototype.Value=function(n){return n===undefined?this.Items:(n.Type==Type.String&&(n=n.Split(TagList.Delimeter)),this.Items.BeginUpdate().Clear().AddRange(n).EndUpdate(),this)};TagList.prototype.ItemsChanged=function(n){var r,t,u=n.Objects,f=u.length,i;switch(n.ModificationType){case ModificationType.Add:for(i=0;i<f;i++)t=new Anchor,t.OnClick.Add(new Delegate(this.RemoveItem,this,[u[i]])),r=(new Span).Text(u[i]).ClassName("tag").Style("display",this.__O),TagList.DeleteIcon==null?t.Text(TagList.DeleteCharacter):t.AddElement((new ImageElement).Source(TagList.DeleteIcon)),r.InsertElement(1,t),this.__S&&(t=(new Anchor).Text(this.__O=="block"?TagList.DownIcon:TagList.RightIcon),t.OnClick.Add(new Delegate(this.MoveItemForward,this,[u[i]])),r.InsertElement(1,t),t=(new Anchor).Text(this.__O=="block"?TagList.UpIcon:TagList.LeftIcon),t.OnClick.Add(new Delegate(this.MoveItemBack,this,[u[i]])),r.InsertElement(1,t)),this.Container.InsertElementBefore(r,this);break;case ModificationType.Clear:case ModificationType.Remove:for(i=f-1;i>=0;i--)this.Container.RemoveElementAt(i+n.Index);break;case ModificationType.Move:case ModificationType.Swap:this.Container.SwapElements(this.Container.DOM.childNodes[n.Index],this.Container.DOM.childNodes[n.Index2]);break;case ModificationType.Update:for(f=this.Container.DOM.childNodes.length-1,i=f-1;i>=0;i--)this.Container.RemoveElementAt(i+n.Index);for(f=this.Items.length,i=0;i<f;i++)t=new Anchor,t.OnClick.Add(new Delegate(this.RemoveItem,this,[u[i]])),r=(new Span).Text(u[i]).ClassName("tag").Style("display",this.__O),TagList.DeleteIcon==null?t.Text(TagList.DeleteCharacter):t.AddElement((new ImageElement).Source(TagList.DeleteIcon)),r.InsertElement(1,t),this.__S&&(t=(new Anchor).Text(this.__O=="block"?TagList.DownIcon:TagList.RightIcon),t.OnClick.Add(new Delegate(this.MoveItemForward,this,[u[i]])),r.InsertElement(1,t),t=(new Anchor).Text(this.__O=="block"?TagList.UpIcon:TagList.LeftIcon),t.OnClick.Add(new Delegate(this.MoveItemBack,this,[u[i]])),r.InsertElement(1,t)),this.Container.InsertElementBefore(r,this)}};TagList.prototype.MoveItemBack=function(n){this.Items.ShiftLeft(this.Items.IndexOf(n))};TagList.prototype.MoveItemForward=function(n){this.Items.ShiftRight(this.Items.IndexOf(n))};TagList.DeleteIcon=null;TagList.DeleteCharacter="☓";TagList.Delimeter=",";TagList.UpIcon="▲";TagList.DownIcon="▼";TagList.LeftIcon="◀";TagList.RightIcon="▶";$PersistedSection=$TextBox;PersistedSection.prototype.LoadValues=function(){for(var r=this.Params,u=r.length,n,i,t=0;t<u;t++)n=r[t],i=this.Values[n.ID()],n.__Default=n.Type==Type.CheckBox?n.Checked():n.Value(),i!==undefined&&(n.Type==Type.CheckBox?n.Checked(i):n.Value(i)),n.OnChange.Add(new Delegate(this.PersistChange,this,[n]))};PersistedSection.prototype.Clear=function(){for(var i=this.Params,r=i.length,n,t=0;t<r;t++)n=i[t],n.Type==Type.CheckBox?n.Checked(n.__Default):n.Value(n.__Default)};PersistedSection.prototype.PersistChange=function(n){n.Type==Type.CheckBox?this.Values.SetValue(n.ID(),n.Checked()):this.Values.SetValue(n.ID(),n.Value());Client.Storage.Local.SetItem(Page.Href()+"_persist",this.Values)};Div.Extensions.Add(new Extension("slideshow",SlideShow));$SlideShow=$TextBox;SlideShow.prototype.Next=function(){return this.GoTo(this.Slides.IndexOf(this.CurrentSlide)+1),this};SlideShow.prototype.Previous=function(){return this.GoTo(this.Slides.IndexOf(this.CurrentSlide)-1),this};SlideShow.prototype.GoTo=function(n){n<0?n=0:n>=this.Slides.length&&(n=this.Slides.length-1);this.PreviousSlide=this.CurrentSlide;this.CurrentSlide=this.Slides[n];switch(this.__Ef){default:this.PreviousSlide!==null&&this.PreviousSlide.Collapsed(!0);this.CurrentSlide.Collapsed(!1)}return this};List.Extensions.Add(new Extension("tree",Tree));$TreeNode=$Tree=$TextBox;Tree.prototype.SelectedNode=function(n){if(n===undefined)return this.__sn;this.__sn!=n&&this.__sn!==null&&this.__sn.__sp.Classes.Remove("selected");n!==null&&(this.Root.__sn=n,n.__sp.Classes.Add("selected"));n.OnSelected.length>0&&n.OnSelected.Fire(new EventArgs(n,null));this.OnSelectedNodeChanged.length>0&&this.OnSelectedNodeChanged.Fire(new EventArgs(this,n))};TreeNode.prototype.Text=function(n){return n===undefined?this.__sp.Text():(this.__sp.Text(n),this)};TreeNode.prototype.Selected=function(n){return n===undefined?this.Root.__sn==this:(n===!0?this.Root.SelectedNode(this):this.Root.__sn==this&&this.Root.SelectedNode(null),this)};TreeNode.prototype.Opened=function(n){return n===undefined?this.ChildTree==null?!1:!this.ChildTree.Collapsed():(n===!0?this.__sp.Classes.Add("opened"):this.__sp.Classes.Remove("opened"),this.ChildTree!=null&&this.ChildTree.Collapsed(!n),this)};
